---
import { ClientRouter } from 'astro:transitions';
import LanguagePicker from '../components/LanguagePicker.astro';
import Background from '../components/Background.astro';
import { ui } from '../i18n/ui';

const { title, lang, description } = Astro.props;
const pageDescription = typeof description === 'string' && description.trim().length
  ? description.trim()
  : 'Sakasu portfolio with interactive star watching and bandit optimization demos.';
const t = ui[lang as keyof typeof ui] ?? ui.en;
const isStarsPage = Astro.url.pathname.includes('/stars');
const isBanditPage = Astro.url.pathname.includes('/bandit');
const navBaseClass = 'shrink-0 whitespace-nowrap rounded-md border px-3 py-1.5 text-xs md:text-sm transition-colors';
---

<!DOCTYPE html>
<html lang={lang} class="scroll-smooth bg-[#111]">
		<head>
			<meta charset="UTF-8" />
			<meta name="viewport" content="width=device-width" />
			<meta name="description" content={pageDescription} />
			<title>{title}</title>
			<ClientRouter />
		</head>
	<body class="text-white font-sans antialiased min-h-screen flex flex-col relative">
		
        <Background />

        <header class="w-full max-w-3xl mx-auto px-4 py-4 md:p-6 border-b border-gray-800/50 relative z-10">
            <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
                <div class="flex items-center justify-between gap-4">
                    <a href={`/${lang}/`} class="font-bold tracking-wider hover:text-blue-400 transition-colors whitespace-nowrap">
                        Sakasu's note
                    </a>
                    <div class="md:hidden shrink-0">
                        <LanguagePicker />
                    </div>
                </div>

                <nav aria-label="Top navigation" class="w-full md:flex-1 md:flex md:justify-center">
                    <div class="flex items-center gap-2 overflow-x-auto pb-1 md:pb-0">
                        <a
                            href={`/${lang}/stars/`}
                            class={`${navBaseClass} ${
                                isStarsPage
                                    ? 'border-blue-400/70 bg-blue-500/15 text-blue-300'
                                    : 'border-gray-700 text-gray-300 hover:border-blue-400/60 hover:text-white'
                            }`}
                        >
                            {t['nav.stars']}
                        </a>
                        <a
                            href={`/${lang}/bandit/`}
                            class={`${navBaseClass} ${
                                isBanditPage
                                    ? 'border-cyan-400/70 bg-cyan-500/15 text-cyan-300'
                                    : 'border-gray-700 text-gray-300 hover:border-cyan-400/60 hover:text-white'
                            }`}
                        >
                            {t['nav.bandit']}
                        </a>
                    </div>
                </nav>

                <div class="hidden md:block shrink-0">
                    <LanguagePicker />
                </div>
            </div>
			</header>

		<main class="w-full max-w-3xl mx-auto p-6 flex-grow relative z-10">
			<slot />
		</main>

        <footer class="text-center p-8 text-gray-600 text-sm relative z-10">
            2025 Sakasu
        </footer>

	</body>
</html>
